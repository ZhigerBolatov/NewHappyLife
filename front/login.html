<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="styles.css">
    <title>Log In - Happy Patient</title>
</head>

<body>
	<header>
		<h1>Happy Patient Medical Center</h1>
		<nav>
			<a href="index.html">Home</a>
			<a href="login.html">Log In</a>
			<a href="regis.html">Registration</a>
		</nav>
	</header>

    <div class="login-container">
        <div class="form-section">
            <h2>Log In</h2>
            <input type="email" id="email" placeholder="Email or IIN" name="happylogin" required />
            <input type="password" id="password" placeholder="Password" name="happypassword" required />
            <p id="incorrect_text" style="color:red; font-size:12px"></p>
            <button id="loginButton" disabled onclick="sent_credential()">Log In</button>
            <a href="forgot_password.html">Forget password?</a>
        </div>
        <div class="image-section"></div>
    </div>

    <script src="js/script.js"></script>
    <script>
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const loginButton = document.getElementById('loginButton');

        function updateButtonState() {
            emailInput.style.backgroundColor = '';
            passwordInput.style.backgroundColor = '';
            document.getElementById('incorrect_text').innerHTML = '';
            if (emailInput.value && passwordInput.value) {
                loginButton.classList.add('active');
                loginButton.disabled = false;
            } else {
                loginButton.classList.remove('active');
                loginButton.disabled = true;
            }
        }

        emailInput.addEventListener('input', updateButtonState);
        passwordInput.addEventListener('input', updateButtonState);

        async function sent_credential(){
            let email = document.getElementById('email');
            let password = document.getElementById('password');
            let credentials = {happylogin:email.value, happypassword:password.value}
            const response = await fetchData('login', 'GET', null);
            if (!response.data.success) {
                email.style.backgroundColor = '#FF2E0D36';
                password.style.backgroundColor = '#FF2E0D36';
                document.getElementById('incorrect_text').innerHTML = '*Incorrect Password or email';
            } else {
                window.location.href = 'index.html';
            }
        }
    </script>
</body>
</html>